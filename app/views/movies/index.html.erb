<% provide(:title, 'Movies Page') %>

<h2>🎥 動画一覧 🎥</h2>

<div class="conteiner">

  <% if current_user.admin? %>
    <%= link_to "動画投稿画面へ", new_movie_url, class: "" %>
  <% end %>

  <section class="movie container" id="all-movie">
    <% @movies.each do |movie|%>
      <div class="movie__inner" style="background: #fff; border: 1px #ccc solid; box-shadow: 0 2px 3px 0 #ddd; font-size: 100%; padding: 20px;">
        <div class="movie__item">
          <div class="movie__title">
            <% if movie.category == "メンバー" %>
              <%= movie.title %>（会員様向け）
            <% else %>
              <%= movie.title %>（一般向け）
            <% end %>
          </div>
          <div class="content__movies">
            <iframe src="https://www.youtube.com/embed/<%= movie.youtube_mid %>"
                    frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
                    <%# allowfullscreen width="560" height="315" > %>
                    allowfullscreen>
            </iframe>
          </div>
          <div class="movie__text">
            <%= movie.text %>
          </div>
          <% if current_user.admin? %>
            <div class="movie__edit">
              <%= link_to "編集", edit_movie_path(movie.id), remote: true, class: "btn btn-success" %>
              <%= link_to '削除', movie_path(movie.id), method: :delete,
                  class: "btn btn-danger",
                  remote: true,
                  data: { confirm: "#{movie.category}動画『#{movie.title}』を削除してよろしいですか？",
                          cancel: 'やめる',
                          commit: '削除する'
                        }, title: '削除確認' 
              %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </section>

</div>

<div id="edit-movie" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>